(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[14],{2177:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/paypal/[payment]",function(){return c(5012)}])},998:function(i,d,a){"use strict";a.d(d,{Ek:function(){return k},gF:function(){return l},"s$":function(){return m},TR:function(){return n},AU:function(){return o},cj:function(){return p}});var e=a(4051),b=a.n(e);function j(c,d,e,f,g,h,i){try{var a=c[h](i),b=a.value}catch(j){e(j);return}a.done?d(b):Promise.resolve(b).then(f,g)}function c(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){var g=a.apply(b,c);function d(a){j(g,e,f,d,h,"next",a)}function h(a){j(g,e,f,d,h,"throw",a)}d(void 0)})}}var f,g,h,k=function(){return{orderNumber:"",orderDesc:"",date_created:"",orderStatus:"processing",accountNumber:"",accountType:"",networkTransId:"",transId:"",userID:"",items:{},user:{},payment:{id:"",paymentMethod:"",currency:"",payer_id:"",status:""},order:{shipping:{name:"",amount:"",description:""},duty:{name:"",amount:"",description:""},credit:{name:"",amount:"",description:""},coupon:{name:"",amount:"",description:""},taxDetail:{name:"",amount:"",description:""},orderCommensts:"",giftNotes:"",total:"",tax:"",subTotal:""},error:""}},l=function(a,b){localStorage.setItem(a,JSON.stringify(b))},m=function(b){var a={};try{a=JSON.parse(localStorage.getItem(b))}catch(c){console.log(c)}return a||(a={}),a},n=(f=c(b().mark(function a(c){var d;return b().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("http://localhost:3000/api/orders/createOrder",{method:"POST",body:JSON.stringify({orderDertails:c}),headers:{"Content-Type":"application/json"}});case 2:return d=a.sent,a.abrupt("return",d);case 4:case"end":return a.stop()}},a)})),function(a){return f.apply(this,arguments)}),o=(g=c(b().mark(function a(c){var d,e;return b().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("http://localhost:3000/api/orders/getOrdersList",{method:"POST",body:JSON.stringify({userID:c})});case 2:return d=a.sent,a.next=5,d.json();case 5:return e=a.sent,a.abrupt("return",e);case 7:case"end":return a.stop()}},a)})),function(a){return g.apply(this,arguments)}),p=(h=c(b().mark(function a(c){var d,e;return b().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("http://localhost:3000/api/orders/getOrdersByID",{method:"POST",body:JSON.stringify({orderID:c})});case 2:return d=a.sent,a.next=5,d.json();case 5:return e=a.sent,a.abrupt("return",e);case 7:case"end":return a.stop()}},a)})),function(a){return h.apply(this,arguments)})},9809:function(i,d,a){"use strict";a.d(d,{J8:function(){return l},uO:function(){return m},Du:function(){return n}});var e=a(4051),b=a.n(e),j=a(998);function k(c,d,e,f,g,h,i){try{var a=c[h](i),b=a.value}catch(j){e(j);return}a.done?d(b):Promise.resolve(b).then(f,g)}function c(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){var g=a.apply(b,c);function d(a){k(g,e,f,d,h,"next",a)}function h(a){k(g,e,f,d,h,"throw",a)}d(void 0)})}}var f,g,h,l=(f=c(b().mark(function a(c,d,e){var f,g;return b().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("http://localhost:3000/api/payment/paypal/capture-order",{method:"POST",body:JSON.stringify(c)});case 2:return f=a.sent,a.next=5,f.json();case 5:d(g=a.sent),e(!1);case 8:case"end":return a.stop()}},a)})),function(a,b,c){return f.apply(this,arguments)}),m=(g=c(b().mark(function a(c,d,e,f){var g;return b().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(200==c.code){g=new Date;try{d.orderNumber=e,d.date_created=g,d.payment.id=c.data.id,d.payment.payer_id=c.data.payer_id,d.payment.status=c.data.status}catch(b){}(0,j.gF)("orderDetails",d),(0,j.TR)(d,d.user.id).then(function(a){200==a.status?f.push("http://localhost:3000/thank-you"):(d.error="Payment Transaction Successfull but Order Save to DB failed",(0,j.gF)("orderDetails",d),setTimeout(function(){f.push("/error")},0))}).catch(function(a){d.error="Payment Transaction Successfull but Order Save to DB failed",(0,j.gF)("orderDetails",d),setTimeout(function(){f.push("/error")},0)})}else d.error="Payment Transaction Failed. Please Try Again",(0,j.gF)("orderDetails",d),setTimeout(function(){f.push("/error")},0);case 1:case"end":return a.stop()}},a)})),function(a,b,c,d){return g.apply(this,arguments)}),n=(h=c(b().mark(function a(c,d,e){var f,g,h,i;return b().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return f="http://localhost:3000",c.preventDefault(),g={currency:d,grandTotal:e},a.next=5,fetch(f+"/api/payment/paypal/create-order",{method:"POST",body:JSON.stringify(g)});case 5:return h=a.sent,a.next=8,h.json();case 8:i=a.sent,window.location.href=i.links[1].href;case 10:case"end":return a.stop()}},a)})),function(a,b,c){return h.apply(this,arguments)})},5012:function(d,b,a){"use strict";a.r(b);var c=a(4051),e=a.n(c),f=a(5893),g=a(7294),h=a(1163),i=a(9809),j=a(998);function k(c,d,e,f,g,h,i){try{var a=c[h](i),b=a.value}catch(j){e(j);return}a.done?d(b):Promise.resolve(b).then(f,g)}b.default=function(p){var l,a=(0,h.useRouter)().query,b=a.token,m=a.PayerID,c=(0,g.useState)({}),q=c[0],r=c[1],d=(0,g.useState)(!0),n=d[0],s=d[1];b||m||h.default.push("checkout"),(0,g.useEffect)((l=e().mark(function a(){return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:(0,i.J8)(b,r,s);case 1:case"end":return a.stop()}},a)}),function(){var a=this,b=arguments;return new Promise(function(d,e){var f=l.apply(a,b);function c(a){k(f,d,e,c,g,"next",a)}function g(a){k(f,d,e,c,g,"throw",a)}c(void 0)})}),[b]);var o={};o=(0,j.s$)("orderDetails");var t=Array.from(Array(20),function(){return Math.floor(20*Math.random()).toString(20)}).join("");return(0,g.useEffect)(function(){!1==n&&(0,i.uO)(q,o,t,h.default)},[n]),(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("div",{style:{height:"400px"},children:(0,f.jsx)("div",{className:"overlay ",children:(0,f.jsxs)("div",{className:"loading ",children:[(0,f.jsx)("div",{class:"spinner-grow text-primary",role:"status",children:(0,f.jsx)("span",{class:"visually-hidden",children:"Loading..."})}),(0,f.jsx)("div",{class:"spinner-grow text-secondary",role:"status",children:(0,f.jsx)("span",{class:"visually-hidden",children:"Loading..."})}),(0,f.jsx)("div",{class:"spinner-grow text-success",role:"status",children:(0,f.jsx)("span",{class:"visually-hidden",children:"Loading..."})}),(0,f.jsx)("div",{class:"spinner-grow text-danger",role:"status",children:(0,f.jsx)("span",{class:"visually-hidden",children:"Loading..."})}),(0,f.jsx)("div",{class:"spinner-grow text-warning",role:"status",children:(0,f.jsx)("span",{class:"visually-hidden",children:"Loading..."})}),(0,f.jsx)("div",{class:"spinner-grow text-info",role:"status",children:(0,f.jsx)("span",{class:"visually-hidden",children:"Loading..."})}),(0,f.jsx)("div",{class:"spinner-grow text-light",role:"status",children:(0,f.jsx)("span",{class:"visually-hidden",children:"Loading..."})}),(0,f.jsx)("div",{class:"spinner-grow text-dark",role:"status",children:(0,f.jsx)("span",{class:"visually-hidden",children:"Loading..."})})]})})})})}}},function(a){a.O(0,[774,888,179],function(){return a(a.s=2177)}),_N_E=a.O()}])